{"ast":null,"code":"var _jsxFileName = \"/Users/mohammadaljagthmi/sei/projects/project3-mars/blogger-website/src/App.js\";\nimport React, { Component } from \"react\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport Nave from \"./Component/Navebar/Nave\";\nimport Home from \"./Component/Home\";\nimport About from \"./Component/About\";\nimport CreatePost from \"./Component/CreatePost\";\nimport { Switch, Route, BrowserRouter as Router } from \"react-router-dom\";\nimport Register from \"./Component/Register\";\nimport Login from \"./Component/Login\";\nimport axios from \"axios\";\nimport { decode } from \"jsonwebtoken\";\nimport PrivateRoute from \"./PrivateRoute\";\nimport { Alert } from \"react-bootstrap\";\nexport default class App extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      user: null,\n      isAuth: false,\n      message: null\n    };\n\n    this.loginHandler = async cred => {\n      let {\n        email,\n        password\n      } = cred;\n\n      try {\n        let data = await axios.post(\"http://localhost:5100/api/auth/login\", {\n          email,\n          password\n        });\n        console.log(\"login:\", data);\n        localStorage.setItem(\"token\", data.data.token);\n        this.getProfile(data.data.token);\n      } catch (err) {\n        this.setState({\n          user: null,\n          isAuth: false,\n          message: err.response.data.message\n        });\n      }\n    };\n\n    this.getProfile = async token => {\n      try {\n        let data = await axios.get(\"http://localhost:5100/api/auth/user\", {\n          headers: {\n            \"x-auth-token\": token\n          }\n        });\n        console.log(\"getProfile\", data);\n        this.setState({\n          isAuth: true,\n          user: data.data.user,\n          message: null\n        });\n      } catch (err) {\n        this.setState({\n          user: null,\n          isAuth: false,\n          message: err.response.data.message\n        });\n      }\n    };\n\n    this.registerHandler = async cred => {\n      try {\n        let data = await axios.post(\"http://localhost:3001/api/auth/register\", cred);\n        localStorage.setItem(\"token\", data.data.token);\n        this.getProfile(data.data.token);\n      } catch (err) {\n        console.log(err);\n        this.setState({\n          user: null,\n          isAuth: false,\n          message: err.response.data.message\n        });\n      }\n    };\n\n    this.onLogoutHandler = e => {\n      e.preventDefault();\n      localStorage.removeItem(\"token\");\n      this.setState({\n        isAuth: false,\n        user: null\n      });\n    };\n  }\n\n  componentDidMount() {\n    let token = localStorage.getItem(\"token\");\n\n    if (!(token == null)) {\n      let user = decode(token);\n\n      if (!user) {\n        localStorage.removeItem(\"token\");\n      }\n\n      this.getProfile(token);\n    }\n  }\n\n  render() {\n    const {\n      isAuth,\n      user\n    } = this.state;\n    const errMessage = this.state.message ? /*#__PURE__*/React.createElement(Alert, {\n      variant: \"danger\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 7\n      }\n    }, this.state.message) : null;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Nave, {\n      user: user,\n      logout: this.onLogoutHandler,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 9\n      }\n    }), errMessage, /*#__PURE__*/React.createElement(Switch, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Route, {\n      path: \"/home\",\n      render: () => /*#__PURE__*/React.createElement(Home, {\n        name: \"yasir\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 45\n        }\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Route, {\n      path: \"/about\",\n      component: About,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(PrivateRoute, {\n      exact: true,\n      path: \"/posting\",\n      isAuth: this.state.isAuth,\n      component: CreatePost,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Route, {\n      path: \"/register\",\n      component: Register,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Route, {\n      path: \"/login\",\n      render: () => isAuth ? /*#__PURE__*/React.createElement(About, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 24\n        }\n      }) : /*#__PURE__*/React.createElement(Login, {\n        login: this.loginHandler,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 35\n        }\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 11\n      }\n    })));\n  }\n\n}","map":{"version":3,"sources":["/Users/mohammadaljagthmi/sei/projects/project3-mars/blogger-website/src/App.js"],"names":["React","Component","Nave","Home","About","CreatePost","Switch","Route","BrowserRouter","Router","Register","Login","axios","decode","PrivateRoute","Alert","App","state","user","isAuth","message","loginHandler","cred","email","password","data","post","console","log","localStorage","setItem","token","getProfile","err","setState","response","get","headers","registerHandler","onLogoutHandler","e","preventDefault","removeItem","componentDidMount","getItem","render","errMessage"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport Nave from \"./Component/Navebar/Nave\";\nimport Home from \"./Component/Home\"\nimport About from \"./Component/About\"\nimport CreatePost from \"./Component/CreatePost\"\nimport { Switch , Route, BrowserRouter as Router } from \"react-router-dom\";\n\nimport Register from \"./Component/Register\";\nimport Login from \"./Component/Login\"\nimport axios from \"axios\";\nimport { decode } from \"jsonwebtoken\";\nimport PrivateRoute from \"./PrivateRoute\";\nimport { Alert } from \"react-bootstrap\";\n\nexport default class App extends Component {\n  state = {\n    user: null,\n    isAuth: false,\n    message: null,\n  };\n\n  loginHandler = async (cred) => {\n    let { email, password } = cred;\n    try {\n      let data = await axios.post(\"http://localhost:5100/api/auth/login\", {\n        email,\n        password,\n      });\n      console.log(\"login:\", data);\n      localStorage.setItem(\"token\", data.data.token);\n\n      this.getProfile(data.data.token);\n    } catch (err) {\n      this.setState({\n        user: null,\n        isAuth: false,\n        message: err.response.data.message,\n      });\n    }\n  };\n\n  getProfile = async (token) => {\n    try {\n      let data = await axios.get(\"http://localhost:5100/api/auth/user\", {\n        headers: { \"x-auth-token\": token },\n      });\n\n      console.log(\"getProfile\", data);\n      this.setState({\n        isAuth: true,\n        user: data.data.user,\n        message: null,\n      });\n    } catch (err) {\n      this.setState({\n        user: null,\n        isAuth: false,\n        message: err.response.data.message,\n      });\n    }\n  };\n\n  registerHandler = async (cred) => {\n    try {\n      let data = await axios.post(\n        \"http://localhost:3001/api/auth/register\",\n        cred\n      );\n      localStorage.setItem(\"token\", data.data.token);\n      this.getProfile(data.data.token);\n    } catch (err) {\n      console.log(err);\n      this.setState({\n        user: null,\n        isAuth: false,\n        message: err.response.data.message,\n      });\n    }\n  };\n\n  onLogoutHandler = (e) => {\n    e.preventDefault();\n    localStorage.removeItem(\"token\");\n    this.setState({\n      isAuth: false,\n      user: null,\n    });\n  };\n\n  componentDidMount() {\n    let token = localStorage.getItem(\"token\");\n    if (!(token == null)) {\n      let user = decode(token);\n\n      if (!user) {\n        localStorage.removeItem(\"token\");\n      }\n\n      this.getProfile(token);\n    }\n  }\n\n  render() {\n    const { isAuth, user } = this.state;\n\n    const errMessage = this.state.message ? (\n      <Alert variant=\"danger\">{this.state.message}</Alert>\n    ) : null;\n\n    return (\n      <div>\n        <Nave user={user} logout={this.onLogoutHandler} />\n        {errMessage}\n        <Switch>\n          <Route path=\"/home\" render={() => <Home name={\"yasir\"} />} />\n          <Route path=\"/about\" component={About} />\n          <PrivateRoute\n            exact\n            path=\"/posting\"\n            isAuth={this.state.isAuth}\n            component={CreatePost}\n          />\n        \n\n          <Route path=\"/register\" component={Register} />\n          <Route\n            path=\"/login\"\n            render={() =>\n              isAuth ? <About/> : <Login login={this.loginHandler} />\n            }\n          />\n        </Switch>\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}